(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{201:function(t,e,n){var content=n(211);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(11).default)("4f72704f",content,!0,{sourceMap:!1})},202:function(t,e,n){var content=n(213);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(11).default)("7a99d29c",content,!0,{sourceMap:!1})},210:function(t,e,n){"use strict";var r=n(201);n.n(r).a},211:function(t,e,n){(e=n(10)(!1)).push([t.i,".multiselect__tag{background-color:#1db954}.searchResults{width:848px;display:flex;flex-wrap:wrap;justify-content:flex-start;margin-top:2rem}.searchResults>*{width:180px;height:180px;box-shadow:0 4px 4px #000;margin:1rem}@media (max-width:1000px){.searchResults{width:636px}}@media (max-width:750px){.searchResults{width:424px}.input{width:300px!important}}@media (max-width:500px){.searchResults{width:212px}.input{width:200px!important}}",""]),t.exports=e},212:function(t,e,n){"use strict";var r=n(202);n.n(r).a},213:function(t,e,n){(e=n(10)(!1)).push([t.i,".searchContainer[data-v-617f7f68]{display:flex;justify-content:center;align-items:center}.input[data-v-617f7f68]{width:500px;color:#000}.createButton[data-v-617f7f68],.input[data-v-617f7f68]{border-radius:.375rem}.createButton[data-v-617f7f68]{background-color:#1db954;padding:.5rem 1rem}.buttonWrapper[data-v-617f7f68]{margin-top:2rem}a[data-v-617f7f68]{color:#1db954;text-decoration:underline}",""]),t.exports=e},215:function(t,e,n){"use strict";n.r(e);n(118);var r,o=n(214),c=(n(20),n(16),n(62),n(205),n(63),n(24),n(2)),l=(n(119),n(209)),d=n.n(l),h={name:"suggestions",data:function(){return{suggestions:[{name:"AViVA",img:"https://artwork-cdn.7static.com/static/img/sleeveart/00/079/320/0007932086_350.jpg"},{name:"Eminem",img:"https://i.scdn.co/image/56f4762485066b4ef867b96e16775f2b5b4db277"},{name:"The Seige",img:"https://i.scdn.co/image/3e56ba003140ad30e8aa5d35c2db603592d4d690"},{name:"Onk Lou",img:"https://i.scdn.co/image/afb7fb59a35df2e6d8e3e7b7c80ac5fa8b2434a5"}]}}},f=n(6),m=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"text-3xl mt-12 -mb-8 ml-4 text-left"},[t._v("Suggestions")]),t._v(" "),n("div",{staticClass:"searchResults"},t._l(t.suggestions,(function(e){return n("div",[n("img",{staticClass:"mb-1",attrs:{src:e.img,width:"180",height:"180"}}),t._v(" "),n("p",[t._v(t._s(e.name))])])})),0)])}),[],!1,null,"ebd1eaf4",null).exports,v={name:"Search",components:{Multiselect:d.a,Suggestions:m},data:function(){return{timer:0,value:[],options:[],loading:!1,success:null}},methods:{delayedInput:function(t){var e=this;clearTimeout(this.timer),this.timer=0,this.timer=setTimeout((function(){""!==t?e.$store.state.user?(e.searchArtists.bind(e,t)(),e.$emit("update",t)):e.$notify({duration:3e3,type:"error",group:"error",text:"You need to login with your Spotify account first."}):e.options=[]}),250)},searchArtists:function(t){var e=this;this.$spotifyApi.search(this.$store.state.token,t).then((function(t){e.options=t.data.artists.items})).catch(console.error)},createMixedArtistPlaylist:(r=Object(c.a)(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.getAllAlbums(this.value);case 4:return e=t.sent,t.next=7,this.getAllTracks(e);case 7:return n=t.sent,n=(n=this.filterOutTracksFromNotWantedArtists(n)).map((function(t){return t.duration_ms=Math.floor(t.duration_ms/1e3),t})),n=this.filterDuplicates(n,["name","duration_ms"]),t.next=13,this.createPlaylist(this.value.map((function(t){return t.name})).join(", "));case 13:return r=t.sent,t.next=16,this.addTracksToPlaylist(r.data.id,n);case 16:this.loading=!1,this.success=!0,this.$notify({duration:3e3,type:"success",group:"success",text:r.data.external_urls.spotify}),t.next=26;break;case 21:t.prev=21,t.t0=t.catch(0),this.$notify({duration:7e3,type:"error",group:"error",text:"Ups, some network issue occurred. The playlist may be incomplete or not present at all. Try again and if the issue keeps happening contact timon.christiansen@code.berlin"}),console.log("Error: ",t.t0),this.loading=!1;case 26:case"end":return t.stop()}}),t,this,[[0,21]])}))),function(){return r.apply(this,arguments)}),filterDuplicates:function(t,e){var n=this;return t.filter((function(t,r,o){return r===o.findIndex((function(r){return n.allEqual(e.map((function(e){return t[e]===r[e]})),!0)}))}))},getAllAlbums:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=[],l=[],d=0;case 1:return t.forEach((function(t){r.push(e.$spotifyApi.getArtistAlbums(e.$store.state.token,t.id,e.$store.state.user.country,d))})),n.next=4,Promise.all(r);case 4:(c=n.sent).forEach((function(t){return l.push.apply(l,Object(o.a)(t.data.items))})),d+=20;case 7:if(null!==c[c.length-1].data.next){n.next=1;break}case 8:return n.abrupt("return",l);case 9:case"end":return n.stop()}}),n)})))()},getAllTracks:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=[],c=[];t.length>0;)l=Math.max(Math.min(t.length,20),0),d=t.splice(0,l),r.push(e.$spotifyApi.getSeveralAlbums(e.$store.state.token,d.map((function(t){return t.id}))));return n.next=4,Promise.all(r);case 4:return n.sent.forEach((function(t){return t.data.albums.forEach((function(t){return c.push.apply(c,Object(o.a)(t.tracks.items))}))})),n.abrupt("return",c);case 7:case"end":return n.stop()}}),n)})))()},filterOutTracksFromNotWantedArtists:function(t){var e=this;return t.filter((function(track){return track.artists.some((function(t){return e.value.some((function(e){return e.id===t.id}))}))}))},createPlaylist:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$spotifyApi.createPlaylist(e.$store.state.token,e.$store.state.user.id,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},addTracksToPlaylist:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var o,c,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=[];e.length>0;)c=Math.max(Math.min(e.length,100),0),l=e.splice(0,c),o.push(n.$spotifyApi.addTracksToPlaylist(n.$store.state.token,t,l.map((function(track){return track.uri}))));return r.next=4,Promise.all(o);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r)})))()},allEqual:function(t,e){return t.every((function(t){return t===e}))}},mounted:function(){var t=this;setTimeout((function(){document.querySelector(".searchContainer input").focus()}),200),window.addEventListener("keyup",(function(e){"/"!==e.key||t.$refs.search.isOpen||document.querySelector(".searchContainer input").focus()}))}},x=(n(210),n(212),{components:{Search:Object(f.a)(v,(function(){var t=this,e=this,n=e.$createElement,r=e._self._c||n;return r("div",{staticClass:"flex flex-col"},[r("div",{staticClass:"searchContainer"},[r("div",[r("multiselect",{ref:"search",staticClass:"input",attrs:{id:"search",label:"name","track-by":"id",multiple:!0,options:e.options,hideSelected:!0,closeOnSelect:!1,placeholder:"Select your beloved artists"},on:{select:function(){t.options=[],t.success=null},"search-change":e.delayedInput},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("p",{staticClass:"text-sm",attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("No Artists found")])])],1)]),e._v(" "),e.value.length>0?r("div",[r("p",{staticClass:"text-3xl mt-12 -mb-8 ml-4 text-left"},[e._v("Your selected Artists")]),e._v(" "),r("div",{staticClass:"searchResults"},e._l(e.value,(function(t){return r("img",{attrs:{src:t.images[0].url,width:"180",height:"180"}})})),0)]):r("Suggestions",{staticClass:"desktop"}),e._v(" "),!e.success&&e.value.length>0?r("div",{staticClass:"buttonWrapper"},[r("button",{staticClass:"createButton ld-ext-left",class:{running:e.loading},on:{click:e.createMixedArtistPlaylist}},[e._v("\n      "+e._s(e.loading?"Creating":"Create Playlist")+"\n      "),r("div",{staticClass:"ld ld-ring ld-spin"})])]):e._e()],1)}),[],!1,null,"617f7f68",null).exports},computed:{cookies:function(){for(var t=document.cookie.split(";"),e={},i=0;i<t.length;i++){var n=t[i].split("=");e[(n[0]+"").trim()]=unescape(n.slice(1).join("="))}return e}},methods:{getHashParams:function(){for(var t,e={},n=/([^&;=]+)=?([^&;]*)/g,q=window.location.hash.substring(1);t=n.exec(q);)e[t[1]]=decodeURIComponent(t[2]);return e}},mounted:function(){var t=localStorage.getItem("state");if(t){var e=this.getHashParams(),n=e.access_token,r=e.state;if(n&&(null==r||r!==t))return void console.log("Error during Authentication");this.$store.commit("SET_TOKEN",n),this.$store.dispatch("FETCH_USER"),localStorage.removeItem("state"),this.$router.push({path:"/"})}this.cookies.spotify_auth_token&&(this.$store.commit("SET_TOKEN",this.cookies.spotify_auth_token),this.$store.dispatch("FETCH_USER"))}}),y=Object(f.a)(x,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("div",{staticClass:"container"},[this._m(0),this._v(" "),e("Search")],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mb-12"},[e("h1",{staticClass:"title"},[e("span",{staticClass:"desktop"},[this._v("\n          BeatMix - Artist Mixer\n        ")])]),this._v(" "),e("p",{staticClass:"subtitle"},[this._v("\n        Your favourite artists in one playlist within seconds.\n      ")])])}],!1,null,"ed875404",null);e.default=y.exports}}]);