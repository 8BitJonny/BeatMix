(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{212:function(t,e,n){var content=n(229);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("2822c660",content,!0,{sourceMap:!1})},213:function(t,e,n){var content=n(231);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("6b6bcc22",content,!0,{sourceMap:!1})},214:function(t,e,n){var content=n(233);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("4f72704f",content,!0,{sourceMap:!1})},215:function(t,e,n){var content=n(235);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("0a4ca55d",content,!0,{sourceMap:!1})},222:function(t,e,n){t.exports=n.p+"img/b52a47b.svg"},228:function(t,e,n){"use strict";var r=n(212);n.n(r).a},229:function(t,e,n){(e=n(8)(!1)).push([t.i,".sub[data-v-9c44690a]{margin-top:.5rem}",""]),t.exports=e},230:function(t,e,n){"use strict";var r=n(213);n.n(r).a},231:function(t,e,n){(e=n(8)(!1)).push([t.i,".settings-wrapper[data-v-23d29ae0]{bottom:100%;border-radius:4px;border:1px solid #282323;background:#191414;box-shadow:0 4px 4px #000;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;color:#fff;text-align:left;white-space:nowrap;margin-bottom:.5rem;padding:.5rem;right:0;position:absolute;user-select:none;outline:0}",""]),t.exports=e},232:function(t,e,n){"use strict";var r=n(214);n.n(r).a},233:function(t,e,n){(e=n(8)(!1)).push([t.i,".multiselect__tag{background-color:#1db954}.searchResults{width:848px;display:flex;flex-wrap:wrap;justify-content:flex-start;margin-top:2rem}.searchResults>*{width:180px;height:180px;box-shadow:0 4px 4px #000;margin:1rem}@media (max-width:1000px){.searchResults{width:636px}}@media (max-width:750px){.searchResults{width:424px}.input{width:300px!important}}@media (max-width:500px){.searchResults{width:212px}.input{width:200px!important}}",""]),t.exports=e},234:function(t,e,n){"use strict";var r=n(215);n.n(r).a},235:function(t,e,n){(e=n(8)(!1)).push([t.i,".searchContainer[data-v-1df93070]{display:flex;justify-content:center;align-items:center}.input[data-v-1df93070]{width:500px;border-radius:.375rem;color:#000}.createButton[data-v-1df93070]{background-color:#1db954;border-radius:.375rem;display:inline-flex}.createButton[data-v-1df93070],.createButton>button[data-v-1df93070]:first-child{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.createButton>button[data-v-1df93070]:first-child{border-right:2px solid #191414;padding:.5rem 1rem;outline:0}.createButton>button[data-v-1df93070]:nth-child(2){padding:.25rem .75rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:0}.buttonWrapper[data-v-1df93070]{margin-top:2rem}a[data-v-1df93070]{color:#1db954;text-decoration:underline}",""]),t.exports=e},237:function(t,e,n){"use strict";n.r(e);n(81),n(83),n(121),n(122),n(20),n(16),n(63);var r,o=n(236),c=(n(223),n(64),n(24),n(2)),l=(n(123),n(227)),d=n.n(l),h={name:"suggestions",data:function(){return{suggestions:[{name:"AViVA",img:"https://artwork-cdn.7static.com/static/img/sleeveart/00/079/320/0007932086_350.jpg"},{name:"Eminem",img:"https://i.scdn.co/image/56f4762485066b4ef867b96e16775f2b5b4db277"},{name:"The Seige",img:"https://i.scdn.co/image/3e56ba003140ad30e8aa5d35c2db603592d4d690"},{name:"Onk Lou",img:"https://i.scdn.co/image/afb7fb59a35df2e6d8e3e7b7c80ac5fa8b2434a5"}]}}},f=(n(228),n(6)),m=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"text-3xl mt-12 -mb-8 ml-4 text-left"},[t._v("Suggestions")]),t._v(" "),n("div",{staticClass:"searchResults"},t._l(t.suggestions,(function(e){return n("div",[n("img",{staticClass:"mb-1",attrs:{src:e.img,width:"180",height:"180"}}),t._v(" "),n("p",{staticClass:"sub"},[t._v(t._s(e.name))])])})),0)])}),[],!1,null,"9c44690a",null).exports,v={name:"settings",data:function(){return{checked:[],options:[{label:"Exlude Live Tracks",value:"live"},{label:"Exlude Instrumental Tracks",value:"instrumental"},{label:"Exlude Commentary Tracks",value:"commentary"}]}},computed:{filters:function(){return this.$store.state.filters}},watch:{filters:function(t){this.checked=t}},mounted:function(){this.checked=this.filters},methods:{handleInput:function(){this.$store.commit("SET_FILTER",this.checked)}}},x=(n(230),Object(f.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"settings-wrapper"},t._l(t.options,(function(option){return n("div",{key:option.value},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],attrs:{type:"checkbox",id:option.value},domProps:{value:option.value,checked:Array.isArray(t.checked)?t._i(t.checked,option.value)>-1:t.checked},on:{change:[function(e){var n=t.checked,r=e.target,o=!!r.checked;if(Array.isArray(n)){var c=option.value,l=t._i(n,c);r.checked?l<0&&(t.checked=n.concat([c])):l>-1&&(t.checked=n.slice(0,l).concat(n.slice(l+1)))}else t.checked=o},t.handleInput]}}),t._v(" "),n("label",{attrs:{for:option.value}},[t._v("\n      "+t._s(option.label)+"\n    ")]),t._v(" "),n("br")])})),0)}),[],!1,null,"23d29ae0",null).exports),k={name:"Search",components:{Multiselect:d.a,Suggestions:m,Settings:x},data:function(){return{timer:0,value:[],options:[],loading:!1,success:null,settingsOpen:!1}},methods:{delayedInput:function(t){var e=this;clearTimeout(this.timer),this.timer=0,this.timer=setTimeout((function(){""!==t?e.$store.state.user?(e.searchArtists.bind(e,t)(),e.$emit("update",t)):e.$notify({duration:3e3,type:"error",group:"error",text:"You need to login with your Spotify account first."}):e.options=[]}),250)},searchArtists:function(t){var e=this;this.$spotifyApi.search(this.$store.state.token,t).then((function(t){e.options=t.data.artists.items})).catch(console.error)},createMixedArtistPlaylist:(r=Object(c.a)(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.getAllAlbums(this.value);case 4:return e=t.sent,t.next=7,this.getAllTracks(e);case 7:return n=t.sent,n=(n=this.filterOutTracksFromNotWantedArtists(n)).map((function(t){return t.duration_ms=Math.floor(t.duration_ms/1e3),t})),n=this.filterDuplicates(n,["name","duration_ms"]),t.next=13,this.createPlaylist(this.value.map((function(t){return t.name})).join(", "));case 13:return r=t.sent,n=this.removeBlacklistedTrackTypes(n),t.next=17,this.addTracksToPlaylist(r.data.id,n);case 17:this.loading=!1,this.success=!0,this.$notify({duration:5e3,type:"success",group:"success",text:r.data.external_urls.spotify}),t.next=27;break;case 22:t.prev=22,t.t0=t.catch(0),this.$notify({duration:9e3,type:"error",group:"error",text:"Ups, some network issue occurred. Try again and if it keeps happening contact timon.christiansen@code.berlin"}),console.log("Error: ",t.t0),this.loading=!1;case 27:case"end":return t.stop()}}),t,this,[[0,22]])}))),function(){return r.apply(this,arguments)}),filterDuplicates:function(t,e){var n=this;return t.filter((function(t,r,o){return r===o.findIndex((function(r){return n.allEqual(e.map((function(e){return t[e]===r[e]})),!0)}))}))},getAllAlbums:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=[],c=0;case 2:if(!(c<t.length)){n.next=16;break}l=t[c],d=void 0,h=0;case 6:return n.next=8,e.$spotifyApi.getArtistAlbums(e.$store.state.token,l.id,e.$store.state.user.country,h);case 8:d=n.sent,r.push.apply(r,Object(o.a)(d.data.items)),h+=50;case 11:if(null!==d.data.next){n.next=6;break}case 12:h=0;case 13:c++,n.next=2;break;case 16:return n.abrupt("return",r);case 17:case"end":return n.stop()}}),n)})))()},getAllTracks:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,c,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=[],c=[];t.length>0;)l=Math.max(Math.min(t.length,20),0),d=t.splice(0,l),r.push(e.$spotifyApi.getSeveralAlbums(e.$store.state.token,d.map((function(t){return t.id}))));return n.next=4,Promise.all(r);case 4:return n.sent.forEach((function(t){return t.data.albums.forEach((function(t){return c.push.apply(c,Object(o.a)(t.tracks.items))}))})),n.abrupt("return",c);case 7:case"end":return n.stop()}}),n)})))()},filterOutTracksFromNotWantedArtists:function(t){var e=this;return t.filter((function(track){return track.artists.some((function(t){return e.value.some((function(e){return e.id===t.id}))}))}))},createPlaylist:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$spotifyApi.createPlaylist(e.$store.state.token,e.$store.state.user.id,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},removeBlacklistedTrackTypes:function(t){var e=this.$store.state.filters.map((function(filter){switch(filter){case"live":return"((?:[\\(-][\\w /]*)Live)";case"instrumental":return"((?:[\\(-][\\w /]*)Instrumental)";case"commentary":return"((?:[\\(-][\\w ]*)Commentary|Commentary(?:\\:))"}})).join("|");if(""===e)return t;var n=new RegExp(e,"i");return t.filter((function(track){return!n.test(track.name)}))},addTracksToPlaylist:function(t,e){var n=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var o,c,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=[];e.length>0;)c=Math.max(Math.min(e.length,100),0),l=e.splice(0,c),o.push(n.$spotifyApi.addTracksToPlaylist(n.$store.state.token,t,l.map((function(track){return track.uri}))));return r.next=4,Promise.all(o);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r)})))()},allEqual:function(t,e){return t.every((function(t){return t===e}))}},mounted:function(){var t=this;setTimeout((function(){document.querySelector(".searchContainer input").focus()}),200),window.addEventListener("keyup",(function(e){"/"!==e.key||t.$refs.search.isOpen||document.querySelector(".searchContainer input").focus()}))}},y=(n(232),n(234),{components:{Search:Object(f.a)(k,(function(){var t=this,e=this,r=e.$createElement,o=e._self._c||r;return o("div",{staticClass:"flex flex-col"},[o("div",{staticClass:"searchContainer"},[o("div",[o("multiselect",{ref:"search",staticClass:"input",attrs:{max:8,id:"search",label:"name","track-by":"id",multiple:!0,options:e.options,hideSelected:!0,closeOnSelect:!1,placeholder:"Select your beloved artists"},on:{select:function(){t.options=[],t.success=null},"search-change":e.delayedInput},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[o("p",{staticClass:"text-sm",attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("No Artists found")])])],1)]),e._v(" "),e.value.length>0?o("div",[o("p",{staticClass:"text-3xl mt-12 -mb-8 ml-4 text-left"},[e._v("Your selected Artists")]),e._v(" "),o("div",{staticClass:"searchResults"},e._l(e.value,(function(t){return o("img",{attrs:{src:t.images[0].url,width:"180",height:"180"}})})),0)]):o("Suggestions",{staticClass:"desktop"}),e._v(" "),!e.success&&e.value.length>0?o("div",{staticClass:"buttonWrapper"},[o("div",{staticClass:"createButton relative"},[o("button",{staticClass:"ld-ext-left",class:{running:e.loading},on:{click:e.createMixedArtistPlaylist}},[e._v("\n        "+e._s(e.loading?"Creating":"Create Playlist")+"\n        "),o("div",{staticClass:"ld ld-ring ld-spin"})]),e._v(" "),o("button",{on:{click:function(t){e.settingsOpen=!e.settingsOpen}}},[o("img",{attrs:{src:n(222),height:"18px",width:"18px"}})]),e._v(" "),e.settingsOpen?o("settings"):e._e()],1)]):e._e()],1)}),[],!1,null,"1df93070",null).exports},computed:{cookies:function(){for(var t=document.cookie.split(";"),e={},i=0;i<t.length;i++){var n=t[i].split("=");e[(n[0]+"").trim()]=unescape(n.slice(1).join("="))}return e}},methods:{getHashParams:function(){for(var t,e={},n=/([^&;=]+)=?([^&;]*)/g,q=window.location.hash.substring(1);t=n.exec(q);)e[t[1]]=decodeURIComponent(t[2]);return e}},mounted:function(){window.location.hostname.includes("herokuapp")&&(window.location="https://beatmix.app");var t=localStorage.getItem("state");if(t){var e=this.getHashParams(),n=e.access_token,r=e.state,o=e.expires_in;if(n&&(null==r||r!==t))return void console.log("Error during Authentication");this.$store.dispatch("SET_TOKEN",{access_token:n,expires_in:o}),this.$store.dispatch("FETCH_USER"),localStorage.removeItem("state"),this.$router.push({path:"/"})}this.cookies.spotify_auth_token&&(this.$store.commit("SET_TOKEN",this.cookies.spotify_auth_token),this.$store.dispatch("FETCH_USER"))}}),w=Object(f.a)(y,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("div",{staticClass:"container"},[this._m(0),this._v(" "),e("Search")],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mb-12"},[e("h1",{staticClass:"title"},[e("span",{staticClass:"desktop"},[this._v("\n          BeatMix for Spotify\n        ")])]),this._v(" "),e("p",{staticClass:"subtitle"},[this._v("\n        Select your favorite artists and enjoy your new playlist with all of their tracks.\n      ")])])}],!1,null,"28761fe5",null);e.default=w.exports}}]);